<script>
  async function receiptDetail(receipt_id) {
    const receipt = await API.response(Production.receipt.findById, receipt_id);
    if (!receipt) { return false; }

    console.log(receipt);

    lib.display("receipt-filter-box", "none");
    lib.display("receipt-detail-box", "");

    let detail_div = document.getElementById("receipt-detail-box");
    detail_div.innerHTML = "";

    let receipt_div = lib.element.create("div", { class: "box b1 container ground border-st padding-5 margin-top-5" });

    receipt_div.append(lib.element.info("b8", "Produção", receipt.production_id));
    receipt_div.append(lib.element.info("b2", "Costureiro(a)", receipt.seamstress_name));
    receipt_div.append(lib.element.info("b3-8", "status", receipt.status));
    receipt_div.append(lib.element.info("b2", "Malote", `${receipt.pouch}/${receipt.preparation_volume}`));
    receipt_div.append(lib.element.info("b2", "Data do recebimento", lib.timestampToFulldate(receipt.datetime)));
    receipt_div.append(lib.element.info("b2", "Data da contagem", lib.timestampToFulldate(receipt.count_datetime)));
    receipt_div.append(lib.element.info("b2", "Lacre", receipt.seal));

    receipt.products.forEach(product => {
      let product_div = lib.element.create("div", { class: "box b1 container border-st radius-5 padding-5 margin-top-5" });
      product_div.append(lib.element.create("div", { class: "mobile-box b2-3 em08 v-center" }, `${product.code} | ${product.name} | ${product.color}`));
      product_div.append(lib.element.info("b6", "Quantidade", product.amount));

      for (let i in receipt.received_products) {
        if (product.product_id == receipt.received_products[i].product_id) {
          product_div.append(lib.element.info("b6", "Recebido", (receipt.received_products[i].amount || "0")));
        }
      };

      receipt_div.append(product_div);
      detail_div.append(receipt_div);
    });
  };

</script>